
# Router (маршрутизация)
___


### Что такое маршрутизация ?
Маршрутизация в PHP - это процесс определения, какой обработчик (контроллер) следует вызвать для обработки запроса, поступающего на веб-сервер. Обычно используется в веб-приложениях для создания "красивых" URL-адресов и упрощения процесса обработки запросов.
В общем случае, маршрутизация в PHP выглядит следующим образом: когда на сервер приходит запрос (запрос URL), сервер запускает определенный скрипт, например index.php, который и обработывает запрос. По умолчанию, такой запрос не содержит никаких параметров, поэтому для работы с параметрами в URL-адресах используются специальные библиотеки и фреймворки.
В современных фреймворках для маршрутизации, обычно используется файл маршрутов (routes.php), который содержит правила для определения, какой обработчик нужно вызывать для каждого URL-адреса. В таких фреймворках можно настроить несколько правил для одного URL, чтобы вызвать разные обработчики в зависимости от переданных параметров.

Вот пример того, как может выглядеть файл маршрутов для фреймворка Laravel:

```php 
Route::get('/', function () {
return view('welcome');
});

Route::get('/about', function () {
return view('about');
});


Route::get('/products/{id}', 'ProductController@show');

```
В этом примере первые две строки содержат правила обработки GET-запросов для базового URL-адреса и страницы "О нас". Третья строка содержит правило для обработки GET-запросов к URL-адресу "/products/{id}", где {id} - это плейсхолдер для переменной. Это правило говорит о том, что для каждого запроса к URL, который начинается с "/products/", нужно вызывать метод "show" из контроллера "ProductController" и передавать значение переменной "id" в качестве параметра.

Таким образом, мы можем использовать маршрутизацию в PHP для обработки запросов на более удобный и гибкий способ, чем это делается при работе с классическими URL-адресами.



### Из каких классов состоит маршрутизатор ?

Маршрутизатор обычно состоит из классов, которые отвечают за обработку запросов, определение маршрутов и вызов соответствующих обработчиков. Основными классами маршрутизатора могут быть:

1. Класс для работы с URL-адресами и запросами, который может определить метод запроса, параметры и т.д.
2. Класс для хранения и обработки маршрутов, который будет получать маршруты из конфигурации и связывать их с соответствующими обработчиками.
3. Класс-обработчик, который будет вызываться по маршруту и выполнять необходимые действия.

Для примера, я могу привести свою реализацию маршрутизатора:
```php 
class Router {

private $routes = [];

public function addRoute($method, $uri, $handler) {
$this->routes[$method][$uri] = $handler;
}

public function dispatch() {
$uri = parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH);
$method = $_SERVER['REQUEST_METHOD'];

    if (isset($this->routes[$method][$uri])) {
      $handler = $this->routes[$method][$uri];
      call_user_func($handler);
    } else {
      http_response_code(404);
      echo '404 Not Found';
    }
}
}

```


В этой реализации маршрутизатора мы имеем класс "Router", который хранит список маршрутов и их обработчиков. Метод "addRoute" добавляет новый маршрут в список, метод "dispatch" обрабатывает текущий запрос и вызывает соответствующий обработчик.

Пример использования моего маршрутизатора:

```php 
$router = new Router();

$router->addRoute('GET', '/', function() {
echo 'Hello, World!';
});

$router->addRoute('GET', '/about', function() {
echo 'About us!';
});

$router->dispatch();

```


В этом примере мы создаем новый объект маршрутизатора, добавляем два маршрута (для базовой страницы и "О нас"), и затем вызываем метод "dispatch" для обработки запроса.





[<< назад](../README.md)